(()=>{"use strict";async function e(e,n){const t=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},referrerPolicy:"origin",body:JSON.stringify(n)});if(!0!==t.redirected)return await t.json();window.location.href=t.url}function n(e,n){let t=document.createElement("span"),r=document.createTextNode(e.errors[n].msg),a=document.createElement("br");return t.appendChild(a),t.appendChild(r),t.style="color: red;",t}var t=document.querySelector("span#username"),r=document.querySelector("span#email"),a=document.querySelector("input#changeUsername"),i=document.querySelector("input#changeEmail"),d=document.querySelector("input#changePassword");a.addEventListener("click",(function(){let r=t.firstElementChild;if(null===r){let r=document.createElement("input");r.type="text",r.value=r.id=t.innerHTML,r.addEventListener("keyup",(function(t){"Enter"===t.key&&e("/user/change-username",{newUsername:this.value}).then((e=>{"OK"===e.status?this.parentNode.innerHTML=this.value:void 0!==e.errors.newUsername&&this.parentNode.appendChild(n(e,"newUsername"))}))})),t.replaceChildren(r)}else t.innerHTML=r.id})),i.addEventListener("click",(function(){let t=r.firstElementChild;if(null===t){let t=document.createElement("input");t.type="text",t.value=t.id=r.innerHTML,t.addEventListener("keyup",(function(t){"Enter"===t.key&&e("/user/change-email",{newEmail:this.value}).then((e=>{"OK"===e.status?this.parentNode.innerHTML=this.value:void 0!==e.errors.newEmail&&this.parentNode.appendChild(n(e,"newEmail"))}))})),r.replaceChildren(t)}else r.innerHTML=t.id})),d.addEventListener("click",(async function(){let t=document.createElement("input"),r=document.createElement("input"),a=document.createElement("div"),i=document.querySelector("div#accountOptions"),d=document.querySelector("div#passwordChange");null!==d?d.remove():(t.type="password",r.type="password",a.className="flexDiv",a.id="passwordChange",t.addEventListener("keyup",(function(e){"Enter"===e.key&&(a.innerHTML="",a.insertAdjacentElement("afterbegin",r),a.insertAdjacentHTML("afterbegin","<h4>Enter your new password</h4>"))})),r.addEventListener("keyup",(function(i){"Enter"===i.key&&e("/user/change-password",{oldPassword:t.value,newPassword:r.value}).then((e=>{"OK"===e.status?a.remove():(t.setAttribute("value",""),r.setAttribute("value",""),a.innerHTML="",a.insertAdjacentElement("afterbegin",t),a.insertAdjacentHTML("afterbegin","<h4>Enter your old password</h4>"),void 0!==e.errors.oldPassword?a.insertAdjacentElement("beforeend",n(e,"oldPassword")):void 0!==e.errors.newPassword&&a.insertAdjacentElement("beforeend",n(e,"newPassword")))})).catch((()=>{}))})),i.insertAdjacentElement("afterend",a),a.insertAdjacentElement("afterbegin",t),a.insertAdjacentHTML("afterbegin","<h4>Enter your old password</h4>"))}))})();